{
  "builders":
  [
       {
      "type": "amazon-ebs",
      "region": "{{user `aws_region`}}",
      "instance_type": "t2.micro",
      "vpc_id": "{{user `vpc_id`}}",
      "subnet_id": "{{user `subnet_id`}}",
    	"force_delete_snapshot": true,
      "encrypt_boot": true,
      "ami_name": "{{user `owner_name`}}-{{user `os_name`}}-{{user `os_version`}}-{{user `type`}}-{{isotime \"2006-01-02-030405\" | clean_ami_name}}",
      "ami_description": "{{user `type`}} CentOS Linux 7 x86_64 HVM EBS (encrypted) {{isotime \"20060102\"}}",
      "source_ami_filter": {
          "filters": {
              "name": "CentOS Linux 7 x86_64 HVM EBS*",
              "owner-alias": "aws-marketplace",
              "virtualization-type": "hvm"
            },
          "owners": ["679593333241"],
          "most_recent": true
        },

      "ami_block_device_mappings": [
        {
          "device_name": "/dev/sda1",
          "volume_type": "gp2",
          "volume_size": "{{user `volume_size`}}",
          "delete_on_termination": true        }
      ],
      "ami_virtualization_type": "hvm",
      "ssh_username": "centos",
      "ssh_pty": true,
      "associate_public_ip_address": false
          }],

  "provisioners": [{
    "type": "shell",
    "inline": [
      "sudo yum clean all",
      "sudo yum update -y",
      "sudo yum clean all"
    ]
  }]
}
